---
title: "Preliminary Analyses"
author: "Ryan Larson"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
header-includes:
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
output: pdf_document
fontsize: 11pt
geometry: margin=0.5in

  
---

```{r library_data, include=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(stargazer)
library(car)
library(effects)
library(plm)
library(lmtest)


#prime-age labor force participation
#weakness of the evidence - identification issue
#AER insighes - Aarons suggestions, journal of labor and economics - editor interested in topic
#SOC journals - Demography, Social Science Research
#Crim journals - more work to motivate DV

#write up research questions/motivation, methods, results - next steps 

#state-specific time trends?

#heterogeneity in effect of time - interact ex-felon share with year (continuous)
#main effect set at 2010 year, 2010 is 0, 2009 is -1, 2008 is -2, etc. 
#graph marginal effect over time

#rolling average effect, run model on each window, collect coefficients/ses and plot them (bandwidth = 5 years)

#make new p4 penultimate analyses document using word



#loading in data/setting working directory
#setwd("C:/Users/DELL/Documents/FE 2017") #set to google drive local folder
fe <- read.csv(file="FE_final.csv", header=T)
```

#"P1: Prime-Age (25-54) Males with lower than Bachelor's Degree level of education"

## P1 Single-Year Analyses

### P1 Descriptive Statistics

```{r, include=F}
fe.ov <- fe %>% select(YEAR, STATENAME, STATEFIP, p1.pop,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p1.y1.notemployed.rate,
                       p1.y2.unemployed.rate, p1.y3.idle.rate, p1.y4.cfw.rate,p1.disab.rate, ssi.rate,
                       p1.marriage.rate, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio, time.indicator)  %>%
                      mutate(norm.weight = p1.pop*(1550/sum(p1.pop)))


```


```{r,echo=F, results='asis'}
stargazer(fe.ov[,-c(1:4,27,28)], type="latex", style="asr", title="Summary Statistics For P1 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.time <- fe.ov %>% group_by(YEAR) %>% summarize(avg = mean(pctexfel))

ggplot(fe.time, aes(x=YEAR, y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Year", y="% Ex-Felon",x="Year")+
  theme_bw()
```



### P1 Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.ov[,-c(1:4,27,28)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov, aes(x=pctexfel, y=p1.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p1.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p1.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov[fe.ov$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p1.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### P1 First-Difference Plots

```{r, include=F}
fe.fd <- fe.ov %>% select(YEAR, STATENAME, p1.y1.notemployed.rate, p1.y3.idle.rate, 
                      p1.y2.unemployed.rate, p1.y4.cfw.rate, pctexfel, time.indicator) %>% 
               group_by(STATENAME) %>%
               mutate(p1.y1.fd = p1.y1.notemployed.rate - dplyr::lag(p1.y1.notemployed.rate),
                      p1.y2.fd = p1.y2.unemployed.rate - dplyr::lag(p1.y2.unemployed.rate),
                      p1.y3.fd = p1.y3.idle.rate - dplyr::lag(p1.y3.idle.rate),
                      p1.y4.fd = p1.y4.cfw.rate - dplyr::lag(p1.y4.cfw.rate,2),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p1.y4.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p1.y4.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak



```{r, echo=F, warning=F}

ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME)+
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")
#  facet_wrap_paginate(~STATENAME, ncol=2, nrow=5, page=i) 




```


\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p1.y4.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak
 
### Overall P1 Models

```{r, include=FALSE}

y1.fe <- plm(p1.y1.notemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p1.y2.unemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p1.y3.idle.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p1.y4.cfw.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak

### Time Split P1 Models

```{r, include=F}
fe.time1 <- fe.ov %>% filter (YEAR<=1985)
fe.time2 <- fe.ov %>% filter (YEAR>=1986)
```

#### P1 Time 1 Models: 1980-1985

```{r, include=FALSE}

y1.fe <- plm(p1.y1.notemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - P1 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p1.y2.unemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```



```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - P1 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p1.y3.idle.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - P1 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

#### P1 Time 2 Models: 1986-2010

```{r, include=FALSE}

y1.fe <- plm(p1.y1.notemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - P1 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p1.y2.unemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - P1 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p1.y3.idle.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - P1 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





### P1 Black Analyses

```{r, include=FALSE}
fe.ov.b <- fe %>% select(YEAR, STATENAME, STATEFIP, p1.pop.b,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p1.y1.notemployed.rate.b,
                       p1.y2.unemployed.rate.b, p1.y3.idle.rate.b, p1.y4.cfw.rate.b, p1.disab.rate.b, ssi.rate,
                       p1.marriage.rate.b, pctexfel.b, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio) %>%
                  rename(p1.y1.notemployed.rate=p1.y1.notemployed.rate.b, p1.y2.unemployed.rate= p1.y2.unemployed.rate.b, 
                         p1.y3.idle.rate=p1.y3.idle.rate.b, p1.y4.cfw.rate=p1.y4.cfw.rate.b,
                         p1.marriage.rate=p1.marriage.rate.b, pctexfel=pctexfel.b) %>% #renaming vars at head, so don't have to change them below
                      mutate(norm.weight = p1.pop.b*(1550/sum(p1.pop.b, na.rm = T)))
```

```{r, include=F}
corr<-round(cor(fe.ov.b[,-c(1:4,27)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov.b[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations - P1 Black", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov.b, aes(x=pctexfel, y=p1.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Black Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p1.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Black Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p1.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Black Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b[fe.ov.b$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p1.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Black Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### P1 Black Models

```{r, include=FALSE}

y1.fe <- plm(p1.y1.notemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - P1 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p1.y2.unemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - P1 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p1.y3.idle.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - P1 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p1.y4.cfw.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression - P1 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





## Aggreagated Analyses (5-Year Bins) - P1: Prime-Age (25-54) Males with lower than Bachelor's Degree level of education


```{r , echo=F}
fe.bin <- fe.ov %>% select(-norm.weight) %>% mutate(yearbin = cut(YEAR, breaks=c(-Inf,1984, 1989, 1994, 1999, 2004, Inf),
                           labels=c("1980-1984","1985-1989","1990-1994","1995-1999","2000-2004","2005-2010"))) %>% 
                    group_by(STATENAME, yearbin) %>%  summarise_at(colnames(fe.ov[c(4:26)]), mean, na.rm=T) %>%
                    mutate_all(funs(replace(., is.nan(.), NA))) %>% ungroup() %>% mutate(norm.weight = p1.pop*(300/sum(p1.pop)))
```

### P1 - Agg. Descriptive Statistics


```{r,echo=F, results='asis'}
stargazer(as.data.frame(fe.bin[,-c(1:3, 26)]), type="latex", style="asr", title="Summary Statistics For P1 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.timebin <- fe.bin %>% group_by(yearbin) %>% summarize(avg = mean(pctexfel))

ggplot(fe.timebin, aes(x=as.numeric(yearbin), y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Yearbin", y="% Ex-Felon",x="Yearbin")+
  theme_bw()
```




### Agg. Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.bin[,-c(1:3, 26)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.bin[,c(14:17,21)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}


stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```




```{r, echo=F}

ggplot(fe.bin, aes(x=pctexfel, y=p1.y1.notemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p1.y2.unemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p1.y3.idle.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin[fe.bin$yearbin %in% c("1995-1999","2000-2004","2005-2010"),], aes(x=pctexfel, y=p1.y4.cfw.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### Agg. P1 First-Difference Plots

```{r, include=F}
fe.fd <- fe.bin %>% select(yearbin, STATENAME, p1.y1.notemployed.rate, p1.y3.idle.rate, 
                      p1.y2.unemployed.rate, p1.y4.cfw.rate, pctexfel) %>% 
               group_by(STATENAME) %>%
               mutate(p1.y1.fd = p1.y1.notemployed.rate - dplyr::lag(p1.y1.notemployed.rate),
                      p1.y2.fd = p1.y2.unemployed.rate - dplyr::lag(p1.y2.unemployed.rate),
                      p1.y3.fd = p1.y3.idle.rate - dplyr::lag(p1.y3.idle.rate),
                      p1.y4.fd = p1.y4.cfw.rate - dplyr::lag(p1.y4.cfw.rate,1),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y4.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y4.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y1.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y2.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y3.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p1.y4.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak


### Agg. Models

```{r, include=FALSE}

y1.fe <- plm(p1.y1.notemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p1.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p1.y2.unemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p1.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p1.y3.idle.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p1.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p1.y4.cfw.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p1.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p1.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak 

#"p2: Working-Age (18-65) Males with lower than Bachelor's Degree level of education"

## P2 Single-Year Analyses

### P2 Descriptive Statistics

```{r, include=F}
fe.ov <- fe %>% select(YEAR, STATENAME, STATEFIP, p2.pop,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p2.y1.notemployed.rate,
                       p2.y2.unemployed.rate, p2.y3.idle.rate, p2.y4.cfw.rate,p2.disab.rate, ssi.rate,
                       p2.marriage.rate, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio, time.indicator) %>%
                      mutate(ssi.rate=ssi.rate*100, norm.weight = p2.pop*(1550/sum(p2.pop)))
  


```


```{r,echo=F, results='asis'}
stargazer(fe.ov[,-c(1:4, 27,28)], type="latex", style="asr", title="Summary Statistics For p2 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.time <- fe.ov %>% group_by(YEAR) %>% summarize(avg = mean(pctexfel))

ggplot(fe.time, aes(x=YEAR, y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Year", y="% Ex-Felon",x="Year")+
  theme_bw()
```



### P2 Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.ov[,-c(1:4,27,28)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov, aes(x=pctexfel, y=p2.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p2.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p2.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov[fe.ov$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p2.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

### p2 First-Difference Plots

```{r, include=F}
fe.fd <- fe.ov %>% select(YEAR, STATENAME, p2.y1.notemployed.rate, p2.y3.idle.rate, 
                      p2.y2.unemployed.rate, p2.y4.cfw.rate, pctexfel, time.indicator) %>% 
               group_by(STATENAME) %>%
               mutate(p2.y1.fd = p2.y1.notemployed.rate - dplyr::lag(p2.y1.notemployed.rate),
                      p2.y2.fd = p2.y2.unemployed.rate - dplyr::lag(p2.y2.unemployed.rate),
                      p2.y3.fd = p2.y3.idle.rate - dplyr::lag(p2.y3.idle.rate),
                      p2.y4.fd = p2.y4.cfw.rate - dplyr::lag(p2.y4.cfw.rate,2),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p2.y4.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p2.y4.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p2.y4.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```


\pagebreak
 
### P2 Overall Models

```{r, include=FALSE}

y1.fe <- plm(p2.y1.notemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p2.y2.unemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p2.y3.idle.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p2.y4.cfw.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak

### P2 Time Split Models

```{r, include=F}
fe.time1 <- fe.ov %>% filter (YEAR<=1985)
fe.time2 <- fe.ov %>% filter (YEAR>=1986)
```

#### P2 Time 1 Models: 1980-1985

```{r, include=FALSE}

y1.fe <- plm(p2.y1.notemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p2 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p2.y2.unemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p2 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p2.y3.idle.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p2 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

#### P2 Time 2 Models: 1986-2010

```{r, include=FALSE}

y1.fe <- plm(p2.y1.notemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p2 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p2.y2.unemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p2 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p2.y3.idle.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p2 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





### P2 Black Analyses

```{r, include=FALSE}
fe.ov.b <- fe %>% select(YEAR, STATENAME, STATEFIP, p2.pop.b,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p2.y1.notemployed.rate.b,
                       p2.y2.unemployed.rate.b, p2.y3.idle.rate.b, p2.y4.cfw.rate.b, p2.disab.rate.b, ssi.rate,
                       p2.marriage.rate.b, pctexfel.b, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio) %>%
                  rename(p2.y1.notemployed.rate=p2.y1.notemployed.rate.b, p2.y2.unemployed.rate= p2.y2.unemployed.rate.b, 
                         p2.y3.idle.rate=p2.y3.idle.rate.b, p2.y4.cfw.rate=p2.y4.cfw.rate.b,
                         p2.marriage.rate=p2.marriage.rate.b, pctexfel=pctexfel.b) %>% #renaming vars at head, so don't have to change them below
                         mutate(norm.weight = p2.pop.b*(1550/sum(p2.pop.b, na.rm=T)))
```

```{r, include=F}
corr<-round(cor(fe.ov.b[,-c(1:4,27)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov.b[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations - p2 Black", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov.b, aes(x=pctexfel, y=p2.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Black Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p2.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Black Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p2.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Black Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b[fe.ov.b$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p2.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Black Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### P2 Black Models

```{r, include=FALSE}

y1.fe <- plm(p2.y1.notemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p2 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p2.y2.unemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p2 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p2.y3.idle.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p2 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p2.y4.cfw.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression - p2 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





## Aggreagated Analyses (5-Year Bins) - P2: Working-Age (18-65) Males with lower than Bachelor's Degree level of education


```{r, echo=F}
fe.bin <- fe.ov %>% select(-norm.weight) %>% mutate(yearbin = cut(YEAR, breaks=c(-Inf,1984, 1989, 1994, 1999, 2004, Inf),
                           labels=c("1980-1984","1985-1989","1990-1994","1995-1999","2000-2004","2005-2010"))) %>% 
                    group_by(STATENAME, yearbin) %>%  summarise_at(colnames(fe.ov[4:26]), mean, na.rm=T) %>%
                    mutate_all(funs(replace(., is.nan(.), NA))) %>% ungroup() %>%
  mutate(norm.weight = p2.pop*(300/sum(p2.pop)))
```

### P2 Agg. Descriptive Statistics


```{r,echo=F, results='asis'}
stargazer(as.data.frame(fe.bin[,-c(1:3,26)]), type="latex", style="asr", title="Summary Statistics For p2 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.timebin <- fe.bin %>% group_by(yearbin) %>% summarize(avg = mean(pctexfel))

ggplot(fe.timebin, aes(x=as.numeric(yearbin), y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Yearbin", y="% Ex-Felon",x="Yearbin")+
  theme_bw()
```




### P2 Agg. Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.bin[,-c(1:3,26)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.bin[,c(14:17,21)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}


stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```




```{r, echo=F}

ggplot(fe.bin, aes(x=pctexfel, y=p2.y1.notemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p2.y2.unemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p2.y3.idle.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin[fe.bin$yearbin %in% c("1995-1999","2000-2004","2005-2010"),], aes(x=pctexfel, y=p2.y4.cfw.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```


\pagebreak

### Agg. p2 First-Difference Plots

```{r, include=F}
fe.fd <- fe.bin %>% select(yearbin, STATENAME, p2.y1.notemployed.rate, p2.y3.idle.rate, 
                      p2.y2.unemployed.rate, p2.y4.cfw.rate, pctexfel) %>% 
               group_by(STATENAME) %>%
               mutate(p2.y1.fd = p2.y1.notemployed.rate - dplyr::lag(p2.y1.notemployed.rate),
                      p2.y2.fd = p2.y2.unemployed.rate - dplyr::lag(p2.y2.unemployed.rate),
                      p2.y3.fd = p2.y3.idle.rate - dplyr::lag(p2.y3.idle.rate),
                      p2.y4.fd = p2.y4.cfw.rate - dplyr::lag(p2.y4.cfw.rate,1),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y4.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y4.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y1.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y2.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y3.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p2.y4.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak

### P2 Agg.  Models

```{r, include=FALSE}

y1.fe <- plm(p2.y1.notemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p2.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p2.y2.unemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p2.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p2.y3.idle.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p2.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p2.y4.cfw.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p2.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p2.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak 

#"p3: Prime-Age (25-54) Males"

## p3 Single-Year Analyses

### p3 Descriptive Statistics

```{r, include=F}
fe.ov <- fe %>% select(YEAR, STATENAME, STATEFIP, p3.pop,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p3.y1.notemployed.rate,
                       p3.y2.unemployed.rate, p3.y3.idle.rate, p3.y4.cfw.rate,p3.disab.rate, ssi.rate,
                       p3.marriage.rate, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio, time.indicator) %>% 
  mutate(norm.weight = p3.pop*(1550/sum(p3.pop)))


```


```{r,echo=F, results='asis'}
stargazer(fe.ov[,-c(1:4,27,28)], type="latex", style="asr", title="Summary Statistics For p3 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.time <- fe.ov %>% group_by(YEAR) %>% summarize(avg = mean(pctexfel))

ggplot(fe.time, aes(x=YEAR, y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Year", y="% Ex-Felon",x="Year")+
  theme_bw()
```



### p3 Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.ov[,-c(1:4,27,28)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov, aes(x=pctexfel, y=p3.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p3.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p3.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov[fe.ov$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p3.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

### p3 First-Difference Plots

```{r, include=F}
fe.fd <- fe.ov %>% select(YEAR, STATENAME, p3.y1.notemployed.rate, p3.y3.idle.rate, 
                      p3.y2.unemployed.rate, p3.y4.cfw.rate, pctexfel, time.indicator) %>% 
               group_by(STATENAME) %>%
               mutate(p3.y1.fd = p3.y1.notemployed.rate - dplyr::lag(p3.y1.notemployed.rate),
                      p3.y2.fd = p3.y2.unemployed.rate - dplyr::lag(p3.y2.unemployed.rate),
                      p3.y3.fd = p3.y3.idle.rate - dplyr::lag(p3.y3.idle.rate),
                      p3.y4.fd = p3.y4.cfw.rate - dplyr::lag(p3.y4.cfw.rate,2),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p3.y4.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p3.y4.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p3.y4.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak
 
### p3 Overall Models

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p3.y4.cfw.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak

### p3 Time Split Models

```{r, include=F}
fe.time1 <- fe.ov %>% filter (YEAR<=1985)
fe.time2 <- fe.ov %>% filter (YEAR>=1986)
```

#### p3 Time 1 Models: 1980-1985

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p3 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p3 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p3 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

#### p3 Time 2 Models: 1986-2010

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p3 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p3 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p3 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





### p3 Black Analyses

```{r, include=FALSE}
fe.ov.b <- fe %>% select(YEAR, STATENAME, STATEFIP, p3.pop.b,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p3.y1.notemployed.rate.b,
                       p3.y2.unemployed.rate.b, p3.y3.idle.rate.b, p3.y4.cfw.rate.b, p3.disab.rate.b, ssi.rate,
                       p3.marriage.rate.b, pctexfel.b, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio) %>%
                  rename(p3.y1.notemployed.rate=p3.y1.notemployed.rate.b, p3.y2.unemployed.rate= p3.y2.unemployed.rate.b, 
                         p3.y3.idle.rate=p3.y3.idle.rate.b, p3.y4.cfw.rate=p3.y4.cfw.rate.b,
                         p3.marriage.rate=p3.marriage.rate.b, pctexfel=pctexfel.b) %>% #renaming vars at head, so don't have to change them below
  mutate(norm.weight = p3.pop.b*(1550/sum(p3.pop.b, na.rm=T)))
```

```{r, include=F}
corr<-round(cor(fe.ov.b[,-c(1:4,27)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov.b[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations - p3 Black", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov.b, aes(x=pctexfel, y=p3.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Black Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p3.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Black Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p3.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Black Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b[fe.ov.b$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p3.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Black Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### p3 Black Models

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p3 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p3.y4.cfw.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

### p3 Female Analyses

```{r, include=FALSE}
fe.ov.w <- fe %>% select(YEAR, STATENAME, STATEFIP, p3.pop.female,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p3.y1.notemployed.rate.w,
                       p3.y2.unemployed.rate.w, p3.y3.idle.rate.w, p3.y4.cfw.rate.w, p3.disab.rate.w, ssi.rate,
                       p3.marriage.rate.w, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio) %>%
                  rename(p3.y1.notemployed.rate=p3.y1.notemployed.rate.w, p3.y2.unemployed.rate= p3.y2.unemployed.rate.w, 
                         p3.y3.idle.rate=p3.y3.idle.rate.w, p3.y4.cfw.rate=p3.y4.cfw.rate.w,
                         p3.marriage.rate=p3.marriage.rate.w) %>% #renaming vars at head, so don't have to change them below
  mutate(norm.weight = p3.pop.female*(1550/sum(p3.pop.female)))
```

```{r, include=F}
corr<-round(cor(fe.ov.w[,-c(1:4,27)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov.w[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations - p3 Female", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov.w, aes(x=pctexfel, y=p3.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Female Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.w, aes(x=pctexfel, y=p3.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Female Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.w, aes(x=pctexfel, y=p3.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Female Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.w[fe.ov.w$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p3.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Female Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### p3 Female Models

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.w, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Female", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.w, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p3 Female", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.w, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Female", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p3.y4.cfw.rate~pctexfel, data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.w, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.w, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression - p3 Female", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak




## Aggreagated Analyses (5-Year Bins) - p3: Prime-Age (25-54) Males 

```{r, echo=F}
fe.bin <- fe.ov %>% select(-norm.weight) %>% mutate(yearbin = cut(YEAR, breaks=c(-Inf,1984, 1989, 1994, 1999, 2004, Inf),
                           labels=c("1980-1984","1985-1989","1990-1994","1995-1999","2000-2004","2005-2010"))) %>% 
                    group_by(STATENAME, yearbin) %>%  summarise_at(colnames(fe.ov[4:26]), mean, na.rm=T) %>%
                    mutate_all(funs(replace(., is.nan(.), NA))) %>% ungroup() %>%
  mutate(norm.weight = p3.pop*(300/sum(p3.pop)))
```

### p3 Agg. Descriptive Statistics


```{r,echo=F, results='asis'}
stargazer(as.data.frame(fe.bin[,-c(1:3,26)]), type="latex", style="asr", title="Summary Statistics For p3 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.timebin <- fe.bin %>% group_by(yearbin) %>% summarize(avg = mean(pctexfel))

ggplot(fe.timebin, aes(x=as.numeric(yearbin), y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Yearbin", y="% Ex-Felon",x="Yearbin")+
  theme_bw()
```




### p3 Agg. Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.bin[,-c(1:3,26)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.bin[,c(14:17,21)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}


stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```




```{r, echo=F}

ggplot(fe.bin, aes(x=pctexfel, y=p3.y1.notemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p3.y2.unemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p3.y3.idle.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin[fe.bin$yearbin %in% c("1995-1999","2000-2004","2005-2010"),], aes(x=pctexfel, y=p3.y4.cfw.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```


\pagebreak

### Agg. p3 First-Difference Plots

```{r, include=F}
fe.fd <- fe.bin %>% select(yearbin, STATENAME, p3.y1.notemployed.rate, p3.y3.idle.rate, 
                      p3.y2.unemployed.rate, p3.y4.cfw.rate, pctexfel) %>% 
               group_by(STATENAME) %>%
               mutate(p3.y1.fd = p3.y1.notemployed.rate - dplyr::lag(p3.y1.notemployed.rate),
                      p3.y2.fd = p3.y2.unemployed.rate - dplyr::lag(p3.y2.unemployed.rate),
                      p3.y3.fd = p3.y3.idle.rate - dplyr::lag(p3.y3.idle.rate),
                      p3.y4.fd = p3.y4.cfw.rate - dplyr::lag(p3.y4.cfw.rate,1),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y4.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y4.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y1.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y2.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y3.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p3.y4.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak

### p3 Agg.  Models

```{r, include=FALSE}

y1.fe <- plm(p3.y1.notemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p3.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p3.y2.unemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p3.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p3.y3.idle.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p3.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p3.y4.cfw.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p3.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p3.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak 

#"p4: Prime-Age (25-54)"

## p4 Single-Year Analyses

### p4 Descriptive Statistics

```{r, include=F}
fe.ov <- fe %>% select(YEAR, STATENAME, STATEFIP, p4.pop,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p4.y1.notemployed.rate,
                       p4.y2.unemployed.rate, p4.y3.idle.rate, p4.y4.cfw.rate,p4.disab.rate, ssi.rate,
                       p4.marriage.rate, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio,time.indicator) %>%
  mutate(norm.weight = p4.pop*(1550/sum(p4.pop)))
 


```


```{r,echo=F, results='asis'}
stargazer(fe.ov[,-c(1:4,27,28)], type="latex", style="asr", title="Summary Statistics For p4 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.time <- fe.ov %>% group_by(YEAR) %>% summarize(avg = mean(pctexfel))

ggplot(fe.time, aes(x=YEAR, y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Year", y="% Ex-Felon",x="Year")+
  theme_bw()
```


### p4 Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.ov[,-c(1:4,27,28)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov, aes(x=pctexfel, y=p4.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p4.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p4.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov[fe.ov$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p4.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak



### p4 First-Difference Plots

```{r, include=F}
fe.fd <- fe.ov %>% select(YEAR, STATENAME, p4.y1.notemployed.rate, p4.y3.idle.rate, 
                      p4.y2.unemployed.rate, p4.y4.cfw.rate, pctexfel, time.indicator) %>% 
               group_by(STATENAME) %>%
               mutate(p4.y1.fd = p4.y1.notemployed.rate - dplyr::lag(p4.y1.notemployed.rate),
                      p4.y2.fd = p4.y2.unemployed.rate - dplyr::lag(p4.y2.unemployed.rate),
                      p4.y3.fd = p4.y3.idle.rate - dplyr::lag(p4.y3.idle.rate),
                      p4.y4.fd = p4.y4.cfw.rate - dplyr::lag(p4.y4.cfw.rate,2),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p4.y4.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p4.y4.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p4.y4.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak
 
### p4 Overall Models

```{r, include=FALSE}

y1.fe <- plm(p4.y1.notemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p4.y2.unemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p4.y3.idle.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p4.y4.cfw.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak

### p4 Time Split Models

```{r, include=F}
fe.time1 <- fe.ov %>% filter (YEAR<=1985)
fe.time2 <- fe.ov %>% filter (YEAR>=1986)
```

#### p4 Time 1 Models: 1980-1985

```{r, include=FALSE}

y1.fe <- plm(p4.y1.notemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p4 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p4.y2.unemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p4 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p4.y3.idle.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p4 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

#### p4 Time 2 Models: 1986-2010

```{r, include=FALSE}

y1.fe <- plm(p4.y1.notemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p4 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p4.y2.unemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p4 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p4.y3.idle.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p4 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





### p4 Black Analyses

```{r, include=FALSE}
fe.ov.b <- fe %>% select(YEAR, STATENAME, STATEFIP, p4.pop.b,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p4.y1.notemployed.rate.b,
                       p4.y2.unemployed.rate.b, p4.y3.idle.rate.b, p4.y4.cfw.rate.b, p4.disab.rate.b, ssi.rate,
                       p4.marriage.rate.b, pctexfel.b, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio) %>%
                  rename(p4.y1.notemployed.rate=p4.y1.notemployed.rate.b, p4.y2.unemployed.rate= p4.y2.unemployed.rate.b, 
                         p4.y3.idle.rate=p4.y3.idle.rate.b, p4.y4.cfw.rate=p4.y4.cfw.rate.b,
                         p4.marriage.rate=p4.marriage.rate.b, pctexfel=pctexfel.b) %>% #renaming vars at head, so don't have to change them below
  mutate( norm.weight = p4.pop.b*(1550/sum(p4.pop.b, na.rm=T)))
```

```{r, include=F}
corr<-round(cor(fe.ov.b[,-c(1:4,27)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov.b[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations - p4 Black", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov.b, aes(x=pctexfel, y=p4.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Black Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p4.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Black Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b, aes(x=pctexfel, y=p4.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Black Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov.b[fe.ov.b$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p4.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Black Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### p4 Black Models

```{r, include=FALSE}

y1.fe <- plm(p4.y1.notemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p4 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p4.y2.unemployed.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p4 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p4.y3.idle.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p4 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p4.y4.cfw.rate~pctexfel, data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov.b, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov.b, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression - p4 Black", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak





## Aggreagated Analyses (5-Year Bins) - p4: Prime-Age (25-54) 

```{r, echo=F}
fe.bin <- fe.ov %>% mutate(yearbin = cut(YEAR, breaks=c(-Inf,1984, 1989, 1994, 1999, 2004, Inf),
                           labels=c("1980-1984","1985-1989","1990-1994","1995-1999","2000-2004","2005-2010"))) %>% 
                    group_by(STATENAME, yearbin) %>%  summarise_at(colnames(fe.ov[4:26]), mean, na.rm=T) %>%
                    mutate_all(funs(replace(., is.nan(.), NA))) %>% ungroup() %>%
  mutate(norm.weight = p4.pop*(300/sum(p4.pop)))
```

### p4 Agg. Descriptive Statistics


```{r,echo=F, results='asis'}
stargazer(as.data.frame(fe.bin[,-c(1:3,26)]), type="latex", style="asr", title="Summary Statistics For p4 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.timebin <- fe.bin %>% group_by(yearbin) %>% summarize(avg = mean(pctexfel))

ggplot(fe.timebin, aes(x=as.numeric(yearbin), y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Yearbin", y="% Ex-Felon",x="Yearbin")+
  theme_bw()
```




### p4 Agg. Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.bin[,-c(1:3,26)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.bin[,c(14:17,21)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}


stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```




```{r, echo=F}

ggplot(fe.bin, aes(x=pctexfel, y=p4.y1.notemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p4.y2.unemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p4.y3.idle.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin[fe.bin$yearbin %in% c("1995-1999","2000-2004","2005-2010"),], aes(x=pctexfel, y=p4.y4.cfw.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```


\pagebreak

### Agg. p4 First-Difference Plots

```{r, include=F}
fe.fd <- fe.bin %>% select(yearbin, STATENAME, p4.y1.notemployed.rate, p4.y3.idle.rate, 
                      p4.y2.unemployed.rate, p4.y4.cfw.rate, pctexfel) %>% 
               group_by(STATENAME) %>%
               mutate(p4.y1.fd = p4.y1.notemployed.rate - lag(p4.y1.notemployed.rate),
                      p4.y2.fd = p4.y2.unemployed.rate - lag(p4.y2.unemployed.rate),
                      p4.y3.fd = p4.y3.idle.rate - lag(p4.y3.idle.rate),
                      p4.y4.fd = p4.y4.cfw.rate - lag(p4.y4.cfw.rate,1),
                      pctexfel.fd = pctexfel - lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y4.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y4.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y1.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y2.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y3.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p4.y4.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak

### p4 Agg.  Models

```{r, include=FALSE}

y1.fe <- plm(p4.y1.notemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p4.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p4.y2.unemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p4.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p4.y3.idle.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p4.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p4.y4.cfw.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p4.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p4.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

#"P5: Young-Adult (18-25)"

## P5 Single-Year Analyses

### P5 Descriptive Statistics

```{r, include=F}
fe.ov <- fe %>% select(YEAR, STATENAME, STATEFIP, p5.pop,popshare.16.25, popshare.26.35, popshare.36.45,
                       popshare.46.55, popshare.56.65, popshare.66.plus, t.unemp.rate,
                       t_1.unemp.rate, t_2.unemp.rate, t_3.unemp.rate, p5.y1.notemployed.rate,
                       p5.y2.unemployed.rate, p5.y3.idle.rate, p5.y4.cfw.rate,p5.disab.rate, ssi.rate,
                       p5.marriage.rate, pctexfel, ssdi.rate, effective.wage, 
                       TANF.mu, z_labor_unemployment_compensatio, time.indicator)  %>%
                      mutate(norm.weight = p5.pop*(1550/sum(p5.pop)))


```


```{r,echo=F, results='asis'}
stargazer(fe.ov[,-c(1:4,27,28)], type="latex", style="asr", title="Summary Statistics For P5 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.time <- fe.ov %>% group_by(YEAR) %>% summarize(avg = mean(pctexfel))

ggplot(fe.time, aes(x=YEAR, y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Year", y="% Ex-Felon",x="Year")+
  theme_bw()
```



### p5 Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.ov[,-c(1:4,27,28)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.ov[,c(15:18,22)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}
#stargazer(upper, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
 #         single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))

stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```


```{r, echo=F}

ggplot(fe.ov, aes(x=pctexfel, y=p5.y1.notemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p5.y2.unemployed.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov, aes(x=pctexfel, y=p5.y3.idle.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.ov[fe.ov$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel, y=p5.y4.cfw.rate, colour=YEAR)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### P5 First-Difference Plots

```{r, include=F}
fe.fd <- fe.ov %>% select(YEAR, STATENAME, p5.y1.notemployed.rate, p5.y3.idle.rate, 
                      p5.y2.unemployed.rate, p5.y4.cfw.rate, pctexfel, time.indicator) %>% 
               group_by(STATENAME) %>%
               mutate(p5.y1.fd = p5.y1.notemployed.rate - dplyr::lag(p5.y1.notemployed.rate),
                      p5.y2.fd = p5.y2.unemployed.rate - dplyr::lag(p5.y2.unemployed.rate),
                      p5.y3.fd = p5.y3.idle.rate - dplyr::lag(p5.y3.idle.rate),
                      p5.y4.fd = p5.y4.cfw.rate - dplyr::lag(p5.y4.cfw.rate,2),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p5.y4.fd, colour=time.indicator)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p5.y4.fd)) +
  facet_wrap(~time.indicator) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak



```{r, echo=F, warning=F}

ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME)+
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")
#  facet_wrap_paginate(~STATENAME, ncol=2, nrow=5, page=i) 




```


\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd[fe.fd$YEAR %in% c(1996,1998,2000,2002,2004,2006,2008,2010),], aes(x=pctexfel.fd, y=p5.y4.fd, colour=time.indicator)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak
 
### Overall p5 Models

```{r, include=FALSE}

y1.fe <- plm(p5.y1.notemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p5.y2.unemployed.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p5.y3.idle.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p5.y4.cfw.rate~pctexfel, data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.ov, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.ov, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak

### Time Split p5 Models

```{r, include=F}
fe.time1 <- fe.ov %>% filter (YEAR<=1985)
fe.time2 <- fe.ov %>% filter (YEAR>=1986)
```

#### p5 Time 1 Models: 1980-1985

```{r, include=FALSE}

y1.fe <- plm(p5.y1.notemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p5 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p5.y2.unemployed.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```



```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p5 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p5.y3.idle.rate~pctexfel, data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time1, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time1, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p5 1980-1985", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak

#### p5 Time 2 Models: 1986-2010

```{r, include=FALSE}

y1.fe <- plm(p5.y1.notemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression - p5 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p5.y2.unemployed.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression - p5 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p5.y3.idle.rate~pctexfel, data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.time2, weights = norm.weight, 
               index = c("STATENAME","YEAR"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.time2, weights = norm.weight, index = c("STATENAME","YEAR"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression - p5 1986-2010", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and Year", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Year FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak










## Aggreagated Analyses (5-Year Bins) - p5: Prime-Age (25-54) Males with lower than Bachelor's Degree level of education


```{r , echo=F}
fe.bin <- fe.ov %>% select(-norm.weight) %>% mutate(yearbin = cut(YEAR, breaks=c(-Inf,1984, 1989, 1994, 1999, 2004, Inf),
                           labels=c("1980-1984","1985-1989","1990-1994","1995-1999","2000-2004","2005-2010"))) %>% 
                    group_by(STATENAME, yearbin) %>%  summarise_at(colnames(fe.ov[c(4:26)]), mean, na.rm=T) %>%
                    mutate_all(funs(replace(., is.nan(.), NA))) %>% ungroup() %>% mutate(norm.weight = p5.pop*(300/sum(p5.pop)))
```

### p5 - Agg. Descriptive Statistics


```{r,echo=F, results='asis'}
stargazer(as.data.frame(fe.bin[,-c(1:3, 26)]), type="latex", style="asr", title="Summary Statistics For p5 Variables",
          summary=T, median=T, covariate.labels=c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation"), header = F)
```


```{r, echo=F}
fe.timebin <- fe.bin %>% group_by(yearbin) %>% summarize(avg = mean(pctexfel))

ggplot(fe.timebin, aes(x=as.numeric(yearbin), y=avg)) +
  geom_line(colour="sky blue", size=2)+
  labs(title="National % Ex-Felon by Yearbin", y="% Ex-Felon",x="Yearbin")+
  theme_bw()
```




### Agg. Bivariate correlations

```{r, include=F}
corr<-round(cor(fe.bin[,-c(1:3, 26)], use="pairwise.complete.obs", method="pearson" ),2)
corr[upper.tri(corr)] <-""
upper <- as.matrix(corr)
rownames(upper) <- c("Population Share 16-25","Population Share 26-35",
                                                  "Population Share 36-45","Population Share 46-55",
                                                  "Population Share 56-65","Population Share 66+",
                                                  "Ovr. Unemployment Rate t","Ovr. Unemployment Rate t-1",
                                                  "Ovr. Unemployment Rate t-2","Ovr. Unemployment Rate t-3",
                                                  "Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate",
                                                  "Disability Rate","SSI Rate","Marriage Rate",
                                                  "Ex-Felon Percentage","SSDI Rate",
                                                  "Effective Wage","Mean TANF Maximum",
                                                  "Unemployment Compensation")

corr2<-round(cor(fe.bin[,c(14:17,21)], use="pairwise.complete.obs", method="pearson" ),2)
corr2[upper.tri(corr2)] <-""
upper2 <- as.matrix(corr2)
rownames(upper2) <- c("Not Employed Rate","Unemployment Rate", "Idleness Rate", "Can't Find Work Rate","Ex-Felon Percentage")
```


```{r, results='asis', echo=F}


stargazer(upper2, header=F, title="Pairwise Correlations", font.size="small", column.sep.width = "0.15pt",
          single.row=TRUE,covariate.labels=c(as.character(paste(c("Variable",1:20)))))
```




```{r, echo=F}

ggplot(fe.bin, aes(x=pctexfel, y=p5.y1.notemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Not Employed Rate")+
  ggtitle("Scatterplot of Not Employed Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p5.y2.unemployed.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Unemployment Rate")+
  ggtitle("Scatterplot of Unemployment Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin, aes(x=pctexfel, y=p5.y3.idle.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Idleness Rate")+
  ggtitle("Scatterplot of Idleness Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")
```

```{r, echo=F}
ggplot(fe.bin[fe.bin$yearbin %in% c("1995-1999","2000-2004","2005-2010"),], aes(x=pctexfel, y=p5.y4.cfw.rate, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  geom_smooth(method="loess", se=F, colour="green")+
  theme_bw()+
  xlab("Percent Ex Felon")+
  ylab("Can't Find Work Rate")+
  ggtitle("Scatterplot of Can't Find Work Rate with % Ex-Felon")+
  labs(subtitle="OLS and LOESS Fits")


  
```

\pagebreak

### Agg. p5 First-Difference Plots

```{r, include=F}
fe.fd <- fe.bin %>% select(yearbin, STATENAME, p5.y1.notemployed.rate, p5.y3.idle.rate, 
                      p5.y2.unemployed.rate, p5.y4.cfw.rate, pctexfel) %>% 
               group_by(STATENAME) %>%
               mutate(p5.y1.fd = p5.y1.notemployed.rate - dplyr::lag(p5.y1.notemployed.rate),
                      p5.y2.fd = p5.y2.unemployed.rate - dplyr::lag(p5.y2.unemployed.rate),
                      p5.y3.fd = p5.y3.idle.rate - dplyr::lag(p5.y3.idle.rate),
                      p5.y4.fd = p5.y4.cfw.rate - dplyr::lag(p5.y4.cfw.rate,1),
                      pctexfel.fd = pctexfel - dplyr::lag(pctexfel))


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplot of First Differences - Not Employed Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplot of First Differences - Unemployment Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplot of First Differences - Idleness Rate")+
  labs(subtitle="OLS Fit")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y4.fd, colour=yearbin)) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplot of First Differences - CFW Rate")+
  labs(subtitle="OLS Fit")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="limegreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="lightblue")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployment Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="yellow")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by Period")+
  labs(subtitle="OLS Fit ")
```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y4.fd)) +
  facet_wrap(~yearbin) +
  geom_point(colour="forestgreen")+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by Period")+
  labs(subtitle="OLS Fit ")
```

\pagebreak

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y1.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Not Employed Rate")+
  ggtitle("Scatterplots of First Differences - Not Employed Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y2.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Unemployement Rate")+
  ggtitle("Scatterplots of First Differences - Unemployment Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y3.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in Idleness Rate")+
  ggtitle("Scatterplots of First Differences - Idleness Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

```{r, echo=F, warning=F}
ggplot(fe.fd, aes(x=pctexfel.fd, y=p5.y4.fd, colour=yearbin)) +
  facet_wrap(~STATENAME) +
  geom_point()+
  geom_smooth(method="lm",se=F, colour="red")+
  theme_bw()+
  xlab("1-Year Change in Percent Ex Felon")+
  ylab("1- Year Change in CFW Rate")+
  ggtitle("Scatterplots of First Differences - CFW Rate by State")+
  labs(subtitle="OLS Fit ", colour="Time Period")


```

\pagebreak


### Agg. Models

```{r, include=FALSE}

y1.fe <- plm(p5.y1.notemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.robust <- coeftest(y1.fe, vcov=vcovHC(y1.fe,type="HC0",cluster=c("group","time")))

y1.fe.2 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.2.robust <- coeftest(y1.fe.2, vcov=vcovHC(y1.fe.2,type="HC0",cluster=c("group","time")))


y1.fe.3 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y1.fe.3.robust <- coeftest(y1.fe.3, vcov=vcovHC(y1.fe.3,type="HC0",cluster=c("group","time")))


y1.fe.4 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.4.robust <- coeftest(y1.fe.4, vcov=vcovHC(y1.fe.4,type="HC0",cluster=c("group","time")))


y1.fe.5 <- plm(p5.y1.notemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y1.fe.5.robust <- coeftest(y1.fe.5, vcov=vcovHC(y1.fe.5,type="HC0",cluster=c("group","time")))

y1.fe.robust.se <- list(y1.fe.robust[,2], y1.fe.2.robust[,2], y1.fe.3.robust[,2], y1.fe.4.robust[,2], y1.fe.5.robust[,2])
y1.fe.robust.p <- list(y1.fe.robust[,4], y1.fe.2.robust[,4], y1.fe.3.robust[,4], y1.fe.4.robust[,4], y1.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y1.fe, y1.fe.2, y1.fe.3, y1.fe.4, y1.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Not-Employed Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y1.fe.robust.se, p=y1.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak



```{r, include=FALSE}

y2.fe <- plm(p5.y2.unemployed.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.robust <- coeftest(y2.fe, vcov=vcovHC(y2.fe,type="HC0",cluster=c("group","time")))

y2.fe.2 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.2.robust <- coeftest(y2.fe.2, vcov=vcovHC(y2.fe.2,type="HC0",cluster=c("group","time")))


y2.fe.3 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y2.fe.3.robust <- coeftest(y2.fe.3, vcov=vcovHC(y2.fe.3,type="HC0",cluster=c("group","time")))


y2.fe.4 <- plm(p5.y2.unemployed.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y2.fe.4.robust <- coeftest(y2.fe.4, vcov=vcovHC(y2.fe.4,type="HC0",cluster=c("group","time")))


y2.fe.robust.se <- list(y2.fe.robust[,2], y2.fe.2.robust[,2], y2.fe.3.robust[,2], y2.fe.4.robust[,2])
y2.fe.robust.p <- list(y2.fe.robust[,4], y2.fe.2.robust[,4], y2.fe.3.robust[,4], y2.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y2.fe, y2.fe.2, y2.fe.3, y2.fe.4,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3"),
          dep.var.caption = "Unemployment Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y2.fe.robust.se, p=y2.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes")))
```



\pagebreak



```{r, include=FALSE}

y3.fe <- plm(p5.y3.idle.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.robust <- coeftest(y3.fe, vcov=vcovHC(y3.fe,type="HC0",cluster=c("group","time")))

y3.fe.2 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.2.robust <- coeftest(y3.fe.2, vcov=vcovHC(y3.fe.2,type="HC0",cluster=c("group","time")))


y3.fe.3 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y3.fe.3.robust <- coeftest(y3.fe.3, vcov=vcovHC(y3.fe.3,type="HC0",cluster=c("group","time")))


y3.fe.4 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.4.robust <- coeftest(y3.fe.4, vcov=vcovHC(y3.fe.4,type="HC0",cluster=c("group","time")))

y3.fe.5 <- plm(p5.y3.idle.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y3.fe.5.robust <- coeftest(y3.fe.5, vcov=vcovHC(y3.fe.5,type="HC0",cluster=c("group","time")))


y3.fe.robust.se <- list(y3.fe.robust[,2], y3.fe.2.robust[,2], y3.fe.3.robust[,2], y3.fe.4.robust[,2])
y3.fe.robust.p <- list(y3.fe.robust[,4], y3.fe.2.robust[,4], y3.fe.3.robust[,4], y3.fe.4.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y3.fe, y3.fe.2, y3.fe.3, y3.fe.4,y3.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Idleness Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y3.fe.robust.se, p=y3.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```


\pagebreak



```{r, include=FALSE}

y4.fe <- plm(p5.y4.cfw.rate~pctexfel, data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.robust <- coeftest(y4.fe, vcov=vcovHC(y4.fe,type="HC0",cluster=c("group","time")))

y4.fe.2 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus, 
               data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.2.robust <- coeftest(y4.fe.2, vcov=vcovHC(y4.fe.2,type="HC0",cluster=c("group","time")))


y4.fe.3 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                 ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio, data = fe.bin, weights = norm.weight, 
               index = c("STATENAME","yearbin"), effect="twoway", model="within")
y4.fe.3.robust <- coeftest(y4.fe.3, vcov=vcovHC(y4.fe.3,type="HC0",cluster=c("group","time")))


y4.fe.4 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                  ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.4.robust <- coeftest(y4.fe.4, vcov=vcovHC(y4.fe.4,type="HC0",cluster=c("group","time")))


y4.fe.5 <- plm(p5.y4.cfw.rate~pctexfel+popshare.26.35+popshare.36.45+popshare.46.55+popshare.56.65+popshare.66.plus+
                   ssi.rate+p5.marriage.rate+effective.wage+TANF.mu+z_labor_unemployment_compensatio+
                  t_1.unemp.rate+t_2.unemp.rate+t_3.unemp.rate+t.unemp.rate,
                  data = fe.bin, weights = norm.weight, index = c("STATENAME","yearbin"), model="within",effect="twoway")
y4.fe.5.robust <- coeftest(y4.fe.5, vcov=vcovHC(y4.fe.5,type="HC0",cluster=c("group","time")))

y4.fe.robust.se <- list(y4.fe.robust[,2], y4.fe.2.robust[,2], y4.fe.3.robust[,2], y4.fe.4.robust[,2], y4.fe.5.robust[,2])
y4.fe.robust.p <- list(y4.fe.robust[,4], y4.fe.2.robust[,4], y4.fe.3.robust[,4], y4.fe.4.robust[,4], y4.fe.5.robust[,4])

```


```{r, results='asis', echo=F}
stargazer(y4.fe, y4.fe.2, y4.fe.3, y4.fe.4, y4.fe.5,
          type="latex", title="Fixed Effects Regression", covariate.labels= c(
                                                  "Ex-Felon Percentage", 
                                                  "Population Share 26-35",
                                                  "Pop. Share 36-45","Pop. Share 46-55",
                                                  "Pop. Share 56-65","Pop. Share 66+", 
                                                  "SSI Rate","Marriage Rate",
                                                  "Effective Wage", "Mean TANF Maximum",  "Unemployment Compensation",
                                                  "Ovr. Unemp. Rate t-1",
                                                  "Ovr. Unemp. Rate t-2","Ovr. Unemp. Rate t-3",
                                                  "Ovr. Unemp. Rate t"),
          dep.var.caption = "Can't Find Work Rate", dep.var.labels.include = FALSE,  header=F, p.auto=F,
          notes="Clustered Standard Errors by State and yearbin", se = y4.fe.robust.se, p=y4.fe.robust.p, 
          star.cutoffs = c(.05, .01, .001), star.char = c("*","**","***"),
          single.row = T, omit.stat="f", font.size="small",
          add.lines = list(c("State FE", "Yes", "Yes","Yes","Yes","Yes"), 
                           c("Time FE", "Yes", "Yes","Yes","Yes","Yes")))
```

\pagebreak 